<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>document</title>
</head>
<body>
    <p class='ques'>"Здравствуйте! <span id=first>Введите</span> Ваш город"</p>
    <textarea id="area" type="text" value=> </textarea>
    <br>
    <button id="but_1">Запомнить</button>
    <button id="but_2">Да</button>
    <button id="but_3">Нет</button>
    <button class="but_4">Сохранить</button>
    <button id="but_5">Продолжить</button>

    <div id="vote">
        <p class="end">"Выберите свои любимые занятия"</p><Br/>
        <input type="checkbox" class="name" id='ch_1'></input>
        <label for="ch_1">СПАТЬ</label><Br/>
        <input type="checkbox" class="name" id='ch_2'></input>
        <label for="ch_2">ЕСТЬ</label><Br/>
        <input type="checkbox" class="name" id='ch_3'></input>
        <label for="ch_3">ИГРАТЬ</label><Br/>
        <input type="checkbox" class="name" id='ch_4'></input>
        <label for="ch_4">БЕГАТЬ</label><Br/>
        <input type="checkbox" class="name" id='ch_5'></input>
        <label for="ch_5">ТАНЦЕВАТЬ</label><Br/>
        <input type="checkbox" class="name" id='ch_6'></input>
        <label for="ch_6">БУХАТЬ</label><Br/>
       </p>
    </div>

    <style>
        #area, button{
            display: inline-block;
            margin: 10px;
            padding: 8px 10px;
            border-radius: 5px;
            border: 2px solid rgb(65, 44, 132);
            background-color: rgb(197, 233, 197);
        }
        #but_2, #but_3, .but_4, #but_5, div {
            display: none;
        }
        p {
            font-size: large;
            margin-left: 10px;
        }
        
    </style>
    <script>
    $(document).ready(function() {  
        
        localStorage.setItem('area', '');
        function setCookie(name, value) {
            options = {
            path: '/',
            expires: 'Mon, 04-Jan-2021 00:00:00 GMT'
            };

            if (options.expires.toUTCString) {
            options.expires = options.expires.toUTCString();
            }

            let updatedCookie = encodeURIComponent(name) +  encodeURIComponent(value);

            for (let optionKey in options) {
                updatedCookie += "; " + optionKey;
                let optionValue = options[optionKey];
                if (optionValue !== true) {
                    updatedCookie += "=" + optionValue;
                }
            }
            
            document.cookie = updatedCookie;
            document.getElementById("but_5").style.display="inline";
           
        }

        function getCookie(name) {
            let matches = document.cookie.match(new RegExp(
                "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
            ));
            console.log(name,' ',matches);
            return matches ? decodeURIComponent(matches[1]) : '';
        }

        set =() => {
            localStorage.setItem('area', area.value);
            location.reload();
        }  
            
        del = () => {
            localStorage.removeItem('area');
            location.reload();
        }    

        fullend = ()=> {
            document.querySelector('.end').textContent='Ваш выбор';
            document.querySelector('.but_4').style.display="none";
            $('.name').attr('disabled', true);
            for(let i=1; i<7; i++) {
                let chid = 'ch_'+i;
                
                if($('chid').attr('checked')) {
                    setCookie(chid,'checked');
                }
            }
        }

        stor = function() {
            document.getElementById("vote").style.display="inline";
            document.getElementById('but_2').style.display="none";
            document.getElementById('but_3').style.display="none";
            let k=0;
            for (let i=1; i<7; i++) {
                let chid = 'ch_'+i;
                if(getCookie(chid) =="checked") {
                    k++;
                    $('#chid').attr('checked', true);
                }
            }
            if( k > 0) fullend;

            document.querySelector('.but_4').style.display="inline";
            document.querySelector('.but_4').addEventListener('click', fullend);
        }
        area.value = localStorage.getItem(area);
        console.log(area.value);
        if (area.value != ""){
            document.getElementById('first').style.display="none";
            document.getElementById('but_1').style.display="none";
            document.getElementById('but_2').style.display="inline";
            document.getElementById('but_3').style.display="inline";
        }
                                   
        document.getElementById("but_1").addEventListener("click", set);
      //  event => {
      //      console.log('area', ' ',area.value); setCookie('area',area.value)});
      // Дорогой дуг!!! Не получилось у меня соханять и удалять куки через setCookie и delCookie, поэтому еализовано на LocalStorage.
      // код не затер, чтоб были видны попытки сделатьна куки. 
      // Удачи в учебе!!!
        document.getElementById("but_2").addEventListener("click", stor);
        document.getElementById("but_3").addEventListener("click", del);
        document.getElementById("but_5").addEventListener("click", event => {location.reload(), false});
    })            
    </script>
</body>
</html>
